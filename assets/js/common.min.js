$((function(){let window_hsize=window.innerHeight,scroll=$(window).scrollTop(),headerHide=!1;$(window).scroll((function(){window_hsize=window.innerHeight;let newScroll=$(window).scrollTop(),newHeaderHide=(newScroll>=scroll||newScroll<window_hsize)&&newScroll>=120;headerHide!==newHeaderHide&&(!0===newHeaderHide?$("header").addClass("hide"):$("header").removeClass("hide"),headerHide=newHeaderHide),scroll=newScroll,scroll>=window_hsize/2?$("header").removeClass("fv"):$("header").addClass("fv"),$("#gMenu").css("height",window_hsize+"px"),120<scroll&&scroll<$(document).outerHeight()-window_hsize-50?$("#floatBtn").removeClass("hide"):($("#floatBtn").addClass("hide"),$("#nav_gMenu").prop("checked")||$("#nav_close").prop("checked",!0))})).trigger("scroll"),$(window).resize((function(){$(this).trigger("scroll")})),Modernizr.cookies&&location.pathname.match(/^\/(knowledge|features)\/.+/)&&$(window).scroll((function(){window_hsize<scroll&&$.cookie("read"+location.pathname.replace(/\//g,"_"),"1",{expires:365,path:"/"})})),$('a[href^="#"]').click((function(){$(this).is("[data-folder]")&&$("#"+$(this).data("folder")+"_open").prop("checked",!0);let href=$(this).attr("href"),target,position=$("#"==href||""==href?"html":href).offset().top-20;return position<scroll&&(position-=68),$("html, body").animate({scrollTop:position},500,"swing"),!1})),$(".comment_open, .toggle_open").length&&$(".comment_open, .toggle_open").change((function(){let target=$("#"+$(this).attr("id").replace(/_open$/,""));if(target.length){let position=target.offset().top-20;position<scroll&&(position-=68),$("html, body").animate({scrollTop:position},300,"swing")}})),jQuery.prototype.mousedragscrollable=function(){let target;$(this).each((function(i,e){$(e).mousedown((function(event){return event.preventDefault(),target=$(e),$(e).data({down:!0,move:!1,x:event.clientX,y:event.clientY,scrollleft:$(e).scrollLeft(),scrolltop:$(e).scrollTop()}),!1})),$(e).click((function(event){if($(e).data("move"))return!1}))})),$(document).mousemove((function(event){if($(target).data("down")){event.preventDefault();let move_x=$(target).data("x")-event.clientX,move_y=$(target).data("y")-event.clientY;if(0===move_x&&0===move_y)return;return $(target).data("move",!0),$(target).scrollLeft($(target).data("scrollleft")+move_x),$(target).scrollTop($(target).data("scrolltop")+move_y),!1}})).mouseup((function(event){return $(target).data("down",!1),!1}))},$(".dragScroll").mousedragscrollable(),$(".flowList").slick({arrows:!0,speed:500,slidesToShow:1,infinite:!1,autoplay:!1,centerMode:!0,centerPadding:"7.7%",dots:!0,prevArrow:'<div class="prev"></div>',nextArrow:'<div class="next"></div>'}),$(".calculatorArea .calc_input .parts input").change((function(){let calcNum=$(this).data("calcNum"),epi_price="";$("#calculatorArea"+calcNum+" .calc_input .parts input:checked").each((function(){epi_price+=$(this).val()})),$('[id^="price_'+calcNum+'_"]').removeClass("active"),$("#price_"+calcNum+"_"+epi_price).addClass("active")})),$(".compareUnit").slick({arrows:!0,speed:500,slidesToShow:1,infinite:!1,autoplay:!1,centerMode:!0,centerPadding:"3.85%",dots:!1,prevArrow:'<div class="prev"></div>',nextArrow:'<div class="next"></div>'}).on("beforeChange",(function(event,slick,currentSlide,nextSlide){$(this).next(".compareToggle").children(".compareBtn").removeClass("active"),$(this).next(".compareToggle").children('.compareBtn[data-index="'+nextSlide+'"]').addClass("active")})),$(".compareBtn").click((function(){$("#"+$(this).data("target")).slick("slickGoTo",$(this).data("index"),!1),$(this).parent().children(".compareBtn").removeClass("active"),$(this).addClass("active")})),$("#reserv_date1, #reserv_date2").datepicker(createCalendarOption).blur();let reservForm=$("form#reserv_form"),reservValidator=reservForm.validate({ignore:{},rules:{reserv_date1:{required:!0},reserv_time1:{required:!0},reserv_date2:{required:!0},reserv_time2:{required:!0},reserv_name:{required:!0},reserv_age:{required:!0},reserv_email:{required:!0,email:!0},reserv_tel:{required:!0,telnum:!0},"reserv_request[]":{required:!0},reserv_privacy:{required:!0}},messages:{reserv_date1:{required:"第一希望日を選択してください"},reserv_time1:{required:"第一希望日を選択してください"},reserv_date2:{required:"第二希望日を選択してください"},reserv_time2:{required:"第二希望日を選択してください"},reserv_name:{required:"お名前を入力してください"},reserv_age:{required:"年齢を入力してください"},reserv_email:{required:"メールアドレスを入力してください",email:"メールアドレスの形式で入力してください"},reserv_tel:{required:"電話番号を入力してください",telnum:"電話番号の形式で入力してください"},"reserv_request[]":{required:"ご希望の部位を選択してください"},reserv_privacy:{required:"プライバシーポリシーに同意が必要です"}},groups:{datetime1:"reserv_date1 reserv_time1",datetime2:"reserv_date2 reserv_time2"},errorPlacement:function(error,element){error.appendTo(element.parent().parent())}});function validateErrorScroll(){$.each($("form input, form select, form textarea"),(function(){if($(this).hasClass("error"))return $("#reserv_popup .formWrap").animate({scrollTop:0},{queue:!1}),!1}))}$("#btnReserv").on("click",(function(){if(reservForm.valid()){let button=$("#btnReserv");if(button.hasClass("disabled"))return void console.log("button is disabled.");$.ajax({url:"/reserv/send",type:"post",data:reservForm.serialize(),timeout:1e4,beforeSend:function(xhr,settings){button.addClass("disabled")},complete:function(xhr,textStatus){button.removeClass("disabled")},success:function(result,textStatus,xhr){"success"===result?(window.dataLayer=window.dataLayer||[],dataLayer.push({trackPageview:"/form/thanks",event:"loadready"}),$("#reserv_form")[0].reset(),$("#reserv_popup").addClass("thanks")):(console.log(result),alert("フォーム送信に失敗しました。時間をおいて再度実行してください。"))},error:function(xhr,textStatus,error){console.log("通信エラー"),console.log(xhr),console.log(textStatus),console.log(error),alert("フォーム送信に失敗しました。時間をおいて再度実行してください。")}})}else validateErrorScroll()})),jQuery.validator.addMethod("kana",(function(value,element){return this.optional(element)||/^([ァ-ヶーぁ-ん]+)$/.test(value)}),"全角ひらがな･カタカナを入力してください"),jQuery.validator.addMethod("hiragana",(function(value,element){return this.optional(element)||/^([ぁ-ん]+)$/.test(value)}),"全角ひらがなを入力してください"),jQuery.validator.addMethod("katakana",(function(value,element){return this.optional(element)||/^([ァ-ヶー]+)$/.test(value)}),"全角カタカナを入力してください"),jQuery.validator.addMethod("hankana",(function(value,element){return this.optional(element)||/^([ｧ-ﾝﾞﾟ]+)$/.test(value)}),"半角カタカナを入力してください"),jQuery.validator.addMethod("alphabet",(function(value,element){return this.optional(element)||/^([a-zA-z\s]+)$/.test(value)}),"半角英字を入力してください"),jQuery.validator.addMethod("alphanum",(function(value,element){return this.optional(element)||/^([a-zA-Z0-9]+)$/.test(value)}),"半角英数字を入力してください"),jQuery.validator.addMethod("postnum",(function(value,element){return this.optional(element)||/^\d{3}\-\d{4}$|^[0-9]{7}$/.test(value)}),"郵便番号を入力してください（例:123-4567）"),jQuery.validator.addMethod("mobilenum",(function(value,element){return this.optional(element)||/^0\d0-\d{4}-\d{4}$/.test(value)}),"携帯番号を入力してください（例:010-2345-6789）"),jQuery.validator.addMethod("telnum",(function(value,element){return this.optional(element)||/^(0\d{1,4}[\s-]?\d{1,4}[\s-]?\d{4})$/.test(value)}),"電話番号を入力してください（例:012-345-6789）"),$("#reserv_open").change((function(){$(this).prop("checked")&&(window.dataLayer=window.dataLayer||[],dataLayer.push({trackPageview:"/form",event:"loadready"}))})),$('input[type="radio"], input[type="checkbox"], select').change((function(){let name=$(this).attr("name");name&&(window.dataLayer=window.dataLayer||[],dataLayer.push({event:"event",category:"form_event",action:"select",label:name}))})),$('input[type="text"], input[type="number"], input[type="email"], input[type="tel"]').focus((function(){let name=$(this).attr("name");name&&(window.dataLayer=window.dataLayer||[],dataLayer.push({event:"event",category:"form_event",action:"select",label:name}))}))}));